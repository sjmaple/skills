Client-side token auth and error handling