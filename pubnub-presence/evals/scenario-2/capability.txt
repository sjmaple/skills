User state management and cleanup